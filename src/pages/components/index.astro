---
import Layout from '@layouts/Layout.astro';
import Hero from '@components/sections/Hero.astro';
import SplitPanel from '@components/sections/SplitPanel.astro';
import Features from '@components/sections/Features.astro';
import Stats from '@components/sections/Stats.astro';
import { featureLists } from '@data/features';
import { statsLists } from '@data/stats';
import { logoLists } from '@data/logos';
import CtaBanner from '@components/sections/CtaBanner.astro';
import Faqs from '@components/sections/Faqs.astro';
import { faqLists } from '@data/faqs';
import RecentPosts from '@components/sections/RecentPosts.astro';
import InnerHero from '@components/sections/InnerHero.astro';
import defaultHero from '@assets/images/home/default-hero.jpg';
import defaultHero2 from '@assets/images/home/default-hero-2.png';
import developerImg from '@assets/images/home/developer.jpg';

const seoTitle = "CeFEM Las Rosas - Centro Médico Familiar";
const seoDescription = "Centro de Especialidades Médicas en Las Rosas, Santa Fe. Atención en pediatría, traumatología, ginecología, obstetricia, urología, nutrición y ecografías.";

 
const componentSections = [
    { id: 'hero', name: 'Hero', icon: 'layout' },
    { id: 'innerHero', name: 'Inner Hero', icon: 'layout-template' },
    { id: 'features', name: 'Especialidades', icon: 'package' },
    { id: 'recentPosts', name: 'Blog', icon: 'file-text' },
    { id: 'splitPanel', name: 'Información', icon: 'columns' },
    { id: 'ctaBanner', name: 'Turnos', icon: 'megaphone' },
    { id: 'logos', name: 'Credenciales', icon: 'briefcase' },
    { id: 'stats', name: 'Números', icon: 'bar-chart' },
    { id: 'faqs', name: 'Preguntas', icon: 'help-circle' },
];

 
const heroContent = {
    title: 'Bienvenido a CeFEM Las Rosas',
    description: 'Solicitá tu turno fácilmente por WhatsApp y recibí atención médica confiable en Boulevard Kemmis 843, Las Rosas, Santa Fe.',
    buttons: [
        {
            text: 'Solicitar Turno',
            link: 'https://wa.me/5493471341461',
            target: '_blank',
            imageAlt: 'WhatsApp'
        }
    ],
    backgroundImage: defaultHero2,
    overlayOpacity: 0.2,
    imageAlt: 'Imagen de fondo de CeFEM Las Rosas'
};

 
const innerHeroContent = {
    title: 'CeFEM Las Rosas',
    description: 'Atención médica especializada en pediatría, traumatología, ginecología, obstetricia, urología, nutrición y ecografías.',
    backgroundImage: defaultHero,
    overlayOpacity: 0.5,
    imageAlt: 'Imagen de fondo de CeFEM Las Rosas'
};

 
const featuresSection = {
    eyebrow: "NUESTRAS ESPECIALIDADES",
    title: "Atención Médica Integral",
    description: "Brindamos servicios en pediatría, traumatología, ginecología, obstetricia, urología, nutrición y ecografías.",
    features: featureLists.main.features,  
    button: {
        text: "Ver Todas las Especialidades",
        link: "/especialidades",
        variant: "primary" as const
    }
};

 
const FooterCta = {
    eyebrow: "SOLICITÁ TU TURNO",
    title: 'Turnos rápidos y confiables',
    description: 'Completá tu solicitud de turno por WhatsApp y coordiná tu visita al Centro Médico.',
    hideCta: false,
    button: {
        text: 'Escribinos por WhatsApp',
        link: 'https://wa.me/5493471341461',
        target: '_blank'
    }
};

 
const styleGuideSection = {
    eyebrow: "INFORMACIÓN DEL CENTRO",
    headline: "Conocé más sobre CeFEM Las Rosas",
    description: "Contamos con infraestructura moderna y profesionales especializados para brindar la mejor atención médica a nuestra comunidad.",
    image: {
        src: developerImg,
        alt: "Equipo médico trabajando"
    },
    buttons: [
        {
            text: "Conocé el Centro",
            link: "/centro",
            variant: "primary" as const
        }
    ]
};

 
const sideBySideStats = {
    eyebrow: "NUESTROS NÚMEROS",
    title: "Pacientes y Experiencia",
    description: "Más de 20 años brindando atención médica confiable y personalizada.",
    variant: 'side-by-side' as const,
    background: 'dark' as const,
    stats: statsLists.main?.stats || [],
    content: {
        title: 'Confianza y Experiencia',
        description: 'Nuestro equipo médico está formado por especialistas altamente capacitados.',
        button: {
            text: 'Conocé al equipo',
            link: '/equipo',
            variant: 'primary' as const
        }
    }
};

const mainCta = {
    eyebrow: "RESERVÁ TU TURNO",
    title: "Coordiná tu visita en minutos",
    description: "Nuestro sistema vía WhatsApp te permite solicitar tu turno de manera rápida y segura.",
    button: {
        text: "Solicitar Turno",
        link: "https://wa.me/5493471341461",
        variant: "primary" as const,
        target: "_blank" as const
    }
};
 
const logosSection = {
    eyebrow: "CONFIANZA",
    headline: "Instituciones y acreditaciones",
    subheadline: "Nos respaldan socios y acreditaciones que garantizan calidad en la atención.",
    logos: logoLists.main.logos
};

 
const faqsSection = {
    eyebrow: "PREGUNTAS FRECUENTES",
    title: 'Consultas Comunes',
    description: 'Respondemos las dudas más frecuentes sobre nuestros servicios y turnos.',
    faqs: faqLists.main.faqs
};

 
const recentPostsSection = {
    eyebrow: "BLOG",
    title: "Últimas publicaciones",
    description: "Mantente informado sobre salud, tips y novedades de CeFEM Las Rosas.",
    button: {
        text: "Ver Todas las Publicaciones",
        link: "/blog",
        variant: "primary" as const
    }
};

---

<Layout footerCta={FooterCta} title={seoTitle} description={seoDescription}>
    <div class="fixed left-4 top-1/2 transform -translate-y-1/2 z-50 hidden lg:block">
        <div class="bg-white rounded-lg shadow-xl p-3 w-52">
            <div class="flex items-center mb-3 pb-2 border-b">
                <h3 class="font-bold text-sm">Components</h3>
            </div>
            <nav>
                <ul class="space-y-1">
                    {componentSections.map(section => (
                        <li>
                            <a 
                                href={`#${section.id}`} 
                                class="component-nav-link flex items-center p-1.5 rounded-md hover:bg-gray-100 transition-colors text-xs"
                                data-section={section.id}
                            >
                                <span class="icon mr-1.5" data-lucide={section.icon}></span>
                                <span>{section.name}</span>
                            </a>
                        </li>
                    ))}
                </ul>
            </nav>
        </div>
    </div>

    <!-- Component Sections -->
    <section id="hero" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Hero Component
            </div>
            <Hero content={heroContent} />
        </div>
    </section>
    
    <section id="innerHero" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Inner Hero Component
            </div>
            <InnerHero content={innerHeroContent} />
        </div>
    </section>
    
    <section id="features" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Features Component
            </div>
            <Features content={featuresSection} padding="base" background="light" />
        </div>
    </section>
    
    <section id="recentPosts" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Recent Posts Component
            </div>
            <RecentPosts content={recentPostsSection} background="base" padding="base" postsToShow={3} category="Theme Usage"/>
        </div>
    </section>
    
    <section id="splitPanel" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Split Panel Component
            </div>
            <SplitPanel content={styleGuideSection} imagePosition="right" background="light" padding="base" />
        </div>
    </section>
    
    <section id="ctaBanner" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                CTA Banner Component
            </div>
            <CtaBanner content={mainCta} variant="contained" background="light" padding="base" />
        </div>
    </section>
    
    <section id="logos" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Logos Component
            </div>
        </div>
    </section>
    
    <section id="stats" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                Stats Component
            </div>
            <Stats content={sideBySideStats} background='dark' padding="base"/>
        </div>
    </section>
    
    <section id="faqs" class="component-section relative mb-16">
        <div class="component-wrapper relative transition-all duration-500">
            <div class="component-label hidden absolute -bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white py-1 px-3 rounded-md text-xs font-medium z-10 shadow-md">
                FAQs Component
            </div>
            <Faqs content={faqsSection} background="base" padding="base" />
        </div>
    </section>
</Layout>

<script>
    
    document.addEventListener('DOMContentLoaded', () => {
         
        const sections = document.querySelectorAll('.component-section');
        const navLinks = document.querySelectorAll('.component-nav-link');
        const componentWrappers = document.querySelectorAll('.component-wrapper');
        const componentLabels = document.querySelectorAll('.component-label');
        
   
        // @ts-ignore - Lucide is loaded globally but TypeScript doesn't know about it
        if (typeof window.lucide !== 'undefined') {
            // @ts-ignore
            window.lucide.createIcons();
        }
        
 
        const updateActiveLink = () => {
 
            const scrollPosition = window.scrollY;
            
   
            sections.forEach((section, index) => {
                const sectionTop = section.getBoundingClientRect().top + window.scrollY;
                const sectionHeight = section.getBoundingClientRect().height;
                const sectionId = section.getAttribute('id');
                
                if (sectionId && scrollPosition >= sectionTop - 200 && scrollPosition < sectionTop + sectionHeight - 200) {
 
                    navLinks.forEach(link => {
                        link.classList.remove('bg-primary', 'text-white');
                    });
                    
             
                    componentWrappers.forEach((wrapper, i) => {
                        wrapper.classList.remove('border-4', 'border-primary', 'shadow-lg', 'bg-white');
                        componentLabels[i].classList.add('hidden');
                    });
                    
             
                    const activeLink = document.querySelector(`.component-nav-link[data-section="${sectionId}"]`);
                    if (activeLink) {
                        activeLink.classList.add('bg-primary', 'text-white');
                    }
                    
                
                    const activeWrapper = componentWrappers[index];
                    const activeLabel = componentLabels[index];
                    if (activeWrapper) {
                        activeWrapper.classList.add('border-4', 'border-primary', 'shadow-lg', 'bg-white');
                        activeLabel.classList.remove('hidden');
                    }
                }
            });
        };
        
     
        window.addEventListener('scroll', updateActiveLink);
        
       
        updateActiveLink();
        
        
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const href = link.getAttribute('href');
                if (!href) return;
                
                const targetId = href.substring(1);
                const targetSection = document.getElementById(targetId);
                
                if (targetSection) {
                    const targetTop = targetSection.getBoundingClientRect().top + window.scrollY;
                    window.scrollTo({
                        top: targetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });
    });
</script>

<style>
    .component-section {
        scroll-margin-top: 100px;
    }
    
    .component-wrapper {
        position: relative;
        z-index: 1;
    }
</style>