---
import "../styles/global.css";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SEO, siteConfig } from "../data/config";

import { themeSetting } from "../data/config";
const { theme } = themeSetting;

const { SiteName, Separator, defaultDescription } = SEO;

interface Props {
	title?: string;
	description?: string;
	image?: string;
	footerCta?: {
		title: string;
		description: string;
		hideCta: boolean;
		button: {
			text: string;
			link: string;
			target?: string;
		};
	};
	canonicalUrl?: string;
}

const { title, description, image, footerCta, canonicalUrl } = Astro.props;

const pageTitle = title ? (title.toLowerCase().includes(SiteName.toLowerCase()) ? title : `${title} ${Separator} ${SiteName}`) : SiteName;
const pageDescription = description || defaultDescription || '';
const pageImage = image || '';
const canonicalPath = canonicalUrl || Astro.url.pathname;
const fullCanonicalUrl = new URL(canonicalPath, siteConfig.siteUrl).toString();
  
const schema = {
  "@context":"https://schema.org",
  "@type":"MedicalBusiness",
  "name":"cefem - Centro Familiar de Especialidades Médicas",
  "description":"Centro médico en Las Rosas. Pediatría, Clínica médica, Ginecología y Obstetricia, Traumatología y Nutrición.",
  "address":{
    "@type":"PostalAddress",
    "streetAddress":"Boulevard Kemmis 843",
    "addressLocality":"Las Rosas",
    "addressRegion":"Santa Fe",
    "postalCode":"2520",
    "addressCountry":"AR"
  },
  "telephone":"+5493471341461",
  "openingHoursSpecification":[
    {"@type":"OpeningHoursSpecification","dayOfWeek":["Monday","Tuesday","Wednesday","Thursday","Friday"],"opens":"08:00","closes":"12:00"},
    {"@type":"OpeningHoursSpecification","dayOfWeek":["Monday","Tuesday","Wednesday","Thursday","Friday"],"opens":"16:00","closes":"20:00"}
  ],
  "url": siteConfig.siteUrl,
  "image": new URL("/og-image.png", siteConfig.siteUrl).toString(),
  "sameAs": [
    siteConfig.Socials.Facebook
  ]
};

---

<!doctype html>
<html lang="es-AR" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="sitemap" href="/sitemap-index.xml" />
		<link rel="canonical" href={fullCanonicalUrl} />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
		<meta name="description" content={pageDescription} />
		<meta name="robots" content="index, follow" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={fullCanonicalUrl} />
		<meta property="og:title" content={pageTitle} />
		<meta property="og:description" content={pageDescription} />
		{pageImage && <meta property="og:image" content={new URL(pageImage, siteConfig.siteUrl).toString()} />}

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={fullCanonicalUrl} />
		<meta property="twitter:title" content={pageTitle} />
		<meta property="twitter:description" content={pageDescription} />
		{pageImage && <meta property="twitter:image" content={new URL(pageImage, siteConfig.siteUrl).toString()} />}

		<!-- Schema.org (JSON-LD) -->
		<script type="application/ld+json" set:html={JSON.stringify(schema)} />
	</head>
	<body data-theme={theme}>
		<a href="#main-content" class="skip-link">Saltar al contenido principal</a>
		<Header />
		<main id="main-content">
			<slot />
		</main>
		<Footer {footerCta} />

		<!-- Floating WhatsApp Button -->
		<a
			href="https://wa.me/5493471341461"
			target="_blank"
			rel="noopener noreferrer"
			aria-label="Contactar por WhatsApp"
			class="fixed bottom-5 right-5 z-50 bg-green-500 text-white p-3 rounded-full shadow-lg hover:bg-green-600 transition-colors duration-300"
		>
			<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" class="w-7 h-7">
				<path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.269.655 4.357 1.849 6.037l-1.092 3.996 4.045-1.052z"></path>
			</svg>
		</a>

		<!-- Scroll to Top Button -->
		<a id="scrollToTopBtn" href="#" aria-label="Volver arriba" class="fixed bottom-5 left-5 z-50 bg-gray-700 text-white p-3 rounded-full shadow-lg hover:bg-gray-800 transition-opacity duration-300 opacity-0 pointer-events-none">
			<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
				<path d="m18 15-6-6-6 6"/>
			</svg>
		</a>

		<script is:inline>
			document.addEventListener('DOMContentLoaded', () => {
		 
				const observer = new IntersectionObserver((entries) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							entry.target.classList.add('is-visible');
							observer.unobserve(entry.target);
						}
					});
				}, { threshold: 0.1 });

				const targets = document.querySelectorAll('.animate-on-scroll');
				targets.forEach(target => observer.observe(target));

		 
				const scrollToTopBtn = document.getElementById('scrollToTopBtn');
				window.addEventListener('scroll', () => {
					if (window.scrollY > 300) {
						scrollToTopBtn.classList.remove('opacity-0', 'pointer-events-none');
					} else {
						scrollToTopBtn.classList.add('opacity-0', 'pointer-events-none');
					}
				}, { passive: true });
			});
		</script>
	</body>
</html>
<style>
	.skip-link {
		position: absolute;
		left: -9999px;
		top: auto;
		width: 1px;
		height: 1px;
		overflow: hidden;
		z-index: -9999;
	}
	.skip-link:focus, .skip-link:active {
		left: auto;
		top: auto;
		width: auto;
		height: auto;
		margin: 1rem;
		padding: 1rem;
		background: #fff;
		color: #000;
		border: 1px solid #ccc;
		position: static;
		overflow: auto;
		z-index: 9999;
	}
	#main-content {
		/* Opcional: asegura que el ancla funcione correctamente */
		scroll-margin-top: 100px; /* Ajusta este valor a la altura de tu header fijo */
	}

	/* Estilos para la animación de scroll */
	.animate-on-scroll {
		opacity: 0;
		transform: scale(0.95);
		transition: opacity 0.4s ease-out, transform 0.4s ease-out;
	}

	.animate-on-scroll.is-visible {
		opacity: 1;
		transform: scale(1);
	}
</style>
