---
import Button from '@components/ui/Button.astro';
import { Image } from 'astro:assets';

interface HeroContent {
    title: string;
    description: string;
    imageAlt: string; 
    buttons?: {
        text: string;
        link: string;
        variant?: 'primary' | 'secondary' | 'ghostLight' | 'ghostDark';
        size?: 'sm' | 'md' | 'lg';
        target?: string;
    }[];
    backgroundImage?: string | any; 
    overlayOpacity?: number; 
    highlightWord?: string; 
}

interface Props {
    content: HeroContent;
}

const { content } = Astro.props;
const opacity = content.overlayOpacity ?? 0.2;


let highlightedTitle = content.title;
if (content.highlightWord) {
    const parts = content.title.split(new RegExp(`(${content.highlightWord})`, 'gi'));
    highlightedTitle = parts.map((part) => 
        part.toLowerCase() === content.highlightWord?.toLowerCase() 
            ? `<span class="text-primary">${part}</span>` 
            : part
    ).join('');
}
---

<section class="header-offset relative">
    {content.backgroundImage && (
        <div class="absolute inset-0 left-0 top-0 w-full h-full overflow-hidden">
            <Image
                src={content.backgroundImage}
                alt={content.imageAlt} 
                width={1920}
                height={1080}
                class="w-full h-full object-cover"
                quality={70}
                format="webp"
                loading="eager"
                decoding="async"
            />
            <div
                class="hero-background absolute inset-0 left-0 top-0 w-full h-full overflow-hidden"
                style={`opacity: ${opacity};`}
            ></div>
            <!-- Degradado suave en la parte inferior -->
            <div class="absolute bottom-0 left-0 w-full h-1/3 bg-gradient-to-t from-background-base to-transparent"></div>
        </div>
    )}

    <div class="site-container mx-auto px-4 py-large relative z-10 flex flex-col md:items-center md:justify-center md:text-center">
        <h1 class="text-white text-balance" set:html={highlightedTitle}></h1>
        <p class="text-white mt-2 text-balance">{content.description}</p>
        {content.buttons && content.buttons.length > 0 && (
            <div class="flex flex-wrap gap-4 mt-8 justify-center">
                {content.buttons.map((button) => (
                    <Button
                        href={button.link}
                        target={button.target || '_self'}
                        variant={button.variant || 'primary'}
                        size={button.size || 'md'}
                    >
                        {button.text}
                    </Button>
                ))}
            </div>
        )}
    </div>
</section>